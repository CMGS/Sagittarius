{% extends "index.html" %}

{%block content %}
<table>
    <tr>
        <td>发起人:</td>
        <td><a href="/people/{{ event.from_uid_url }}">{{ event.from_uid }}</a></td>
    </tr>
    <tr>
        <td>标题：</td>
        <td>{{ event.title }}</td>
    </tr>
    <tr>
        <td>内容：</td>
        <td>{{ event.content }}</td>
    </tr>
    <tr>
        <td>时间：</td>
        <td>{{ event.start_date }}</td>
    </tr>
<table>
{% if reply %}
<table>
{% for r in reply %}
    <tr>
        <td>时间: {{ r.create_time }}</td>
        <td>内容: {{ r.content }}</td>
        <td>作者: <a href="/people/{{ r.from_uid_url }}">{{ r.from_uid }}</a></td>
    </tr>
{% endfor %}
</table>
{{ render_pagination(list_page, '/event/view/%d/' % event.id) }}
{% else %}
<p>No comments</p>
{% endif %}
{% if not is_interest and not finished %}
<a href="/event/view/{{ event.id }}/?interest=want">想参加</a>
{% elif is_interest and not finished %}
<a href="/event/view/{{ event.id }}/?interest=cancel">取消</a>
{% endif %}

{% if select %}
    <table class="select">
    {% for c in select_list %}
        <tr>
            <td>用户: <a href="/people/{{ c.from_uid_url }}">{{ c.name }}</a></td>
            {% if is_host and not finished %}
            <td><a href="/event/unselect/{{ event.id }}/{{ c.id }}/">取消</a></td>
            {% endif %}
        </tr>
    {% endfor %}
    </table>
{% else %}
    <p>No select</p>
{% endif %}

{% if interest and interest_list and not finished %}
    <table>
    {% for i in interest_list %}
        <tr>
            <td>用户: <a href="/people/{{ i.from_uid_url }}">{{ i.name }}</a></td>
            {% if is_host %}
            <td><a href="/event/select/{{ event.id }}/{{ i.id }}/">邀请</a></td>
            {% endif %}
        </tr>
    {% endfor %}
    </table>
{% elif not finished %}
    <p>No interest</p>
{% endif %}

{% if visit_user and not finished %}
<form method="post" action="/event/reply/{{ event.id }}">
  <ul>
    <li>
        <label for="content">内容</label>
        <textarea name="content" rows="5" cols="10">{{ content }}</textarea>
    </li>
    <li>
        <button type="submit">提交</button>
    </li>
  </ul>
  <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
  <input type="hidden" name="_visit_user" value="{{ visit_user.id }}">
</form>
{% if error %}
<span>{{ error }}</span>
{% endif %}
{% endif %}
{% endblock %}
